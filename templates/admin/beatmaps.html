{% extends 'admin/base.html' %}
{% block title %} Beatmaps {% endblock %}\

{% block content %}
<style>
    .rounded-sm {
        border-radius: 8px !important;
    }

    .rounded {
        border-radius: 0.5em
    }

    .h-100 {
        height: 100%
    }

    .d-flex {
        display: flex;
    }

    .gap-2 {
        grid-gap: 1em 1em;
    }

    .i-text-no-wrap * {
        white-space: nowrap;
    }
</style>
<div class="columns is-marginless">
    <div class="column is-paddingless is-avatar">
        <img src="https://a.{{ domain() }}/{{ session.user_data['id'] }}"
            onError="this.src='/static/images/avatar_notwork.png';" class="header-avatar">
    </div>
    <div class="column is-paddingless flex-vcenter">
        <h2 class="section-title">Beatmaps</h2>
        <p class="section-lead">Welcome to beatmaps panel</p>
    </div>
</div>
<div class="row row-deck row-cards" style="margin-top: 20px">
    <div class="columns is-marginless is-paddingless">
        <div class="column is-paddingless pr-3 py-3">
            <a href="/admin/beatmaps/osu" class="button" style="width: 100%; margin-bottom: 10px">osu!</a>
            <div class="card">
                <div class="title">Total beatmaps</div>
                <i class="fa fa-plus"></i>
                <div class="value">{{ counts['total'] }}</div>
                <div class="stat">That's a lot of maps</div>
            </div>
        </div>
        <div class="column is-paddingless p-3">
            <a href="/admin/beatmaps/taiko" class="button" style="width: 100%; margin-bottom: 10px">osu!taiko</a>
            <div class="card">
                <div class="title">Ranked</div>
                <i class="fa fa-bolt"></i>
                <div class="value">{{ counts['ranked'] }}</div>
                <div class="stat">These maps can gain many pp</div>
            </div>
        </div>
        <div class="column is-paddingless p-3">
            <a href="/admin/beatmaps/catch" class="button" style="width: 100%; margin-bottom: 10px">osu!catch</a>
            <div class="card">
                <div class="title">Loved</div>
                <i class="fa fa-heart"></i>
                <div class="value">{{ counts['loved'] }}</div>
                <div class="stat">We loved them so much</div>
            </div>
        </div>
        <div class="column is-paddingless pl-3 py-3">
            <a href="/admin/beatmaps/mania" class="button" style="width: 100%; margin-bottom: 10px">osu!mania</a>
            <div class="card">
                <div class="title">Pending</div>
                <i class="fa fa-arrows-rotate"></i>
                <div class="value">{{ counts['pending'] }}</div>
                <div class="stat">They are also good maps</div>
            </div>
        </div>
    </div>
    <div class="p-0 d-flex gap-2 py-3">
        <input id="search-bar" class="input" value="{{ search_word }}">
        <button onclick="map_admin_search('bid')" class="button" style="width: 200px">Search by BID</button>
        <button onclick="map_admin_search('sid')" class="button" style="width: 200px">Search by SID</button>
        <button onclick="map_admin_search('name')" class="button" style="width: 200px">Search by Name</button>
    </div>
    <div class="table-responsive py-3">
        <table class="table card-table table-vcenter text-nowrap datatable rounded">
            <thead style="text-align: center;">
                <tr class="i-text-no-wrap">
                    <th>Beatmap</th>
                    <th>CS / Keys</th>
                    <th>AR</th>
                    <th>HP</th>
                    <th>OD</th>
                    <th>BPM</th>
                    <th>Stars</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody style="text-align: center;">
                {% for i in bmap_query %}
                <tr>
                    <td>
                        <div onclick="window.open('https://osu.ppy.sh/beatmapsets/{{ i.set_id }}')" class="card p-0"
                            style="cursor:pointer; background-image: url(https://assets.ppy.sh/beatmaps/{{ i.set_id }}/covers/cover.jpg); background-size: cover; height: 100px; width: 400px;">
                            <div class="card-body rounded-sm h-100 p-4" style="background-color: rgba(0, 0, 0, 0.8);">
                                <a class="play-detail__title">{{ i.title }}
                                    <small style="display: inline;">by {{ i.creator }}</small>
                                </a>
                                <span style="color: #ea0; font-size: 14px">Skystar's Tragic Love Extra</span>
                            </div>
                        </div>
                    </td>
                    <td class="bigger_td">
                        {{ i.cs }}
                    </td>
                    <td class="bigger_td">
                        {{ i.ar }}
                    </td>
                    <td class="bigger_td">
                        {{ i.hp }}
                    </td>
                    <td class="bigger_td">
                        {{ i.od }}
                    </td>
                    <td class="bigger_td">
                        {{ i.bpm }}
                    </td>
                    <td class="bigger_td">
                        {{ i.stars }}
                    </td>
                    <td class="bigger_td">
                        {{ decode_map_status(i.status) }}
                    </td>
                    <td>
                        <div class="dropdown">
                            <div class="dropdown-trigger">
                                <button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
                                    <span>Dropdown button</span>
                                    <span class="icon is-small">
                                        <i class="fas fa-angle-down" aria-hidden="true"></i>
                                    </span>
                                </button>
                            </div>
                            <div class="dropdown-menu" id="dropdown-menu" role="menu">
                                <div class="dropdown-content">
                                    <a href="#" class="dropdown-item">
                                        Dropdown item
                                    </a>
                                    <a class="dropdown-item">
                                        Other dropdown item
                                    </a>
                                    <a href="#" class="dropdown-item is-active">
                                        Active dropdown item
                                    </a>
                                    <a href="#" class="dropdown-item">
                                        Other dropdown item
                                    </a>
                                    <hr class="dropdown-divider">
                                    <a href="#" class="dropdown-item">
                                        With a divider
                                    </a>
                                </div>
                            </div>
                        </div>
                        {# <div>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.map_id }}?status=2&set=0">Ranked</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.map_id }}?status=5&set=0">Loved</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.map_id }}?status=3&set=0">Approved</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.map_id }}?status=0&set=0">Pending</a>
                        </div>
                        <div style="margin-top: 10px">
                            <a class="button" href="/admin/beatmaps/edit/{{ i.set_id }}?status=2&set=1">Ranked Set</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.set_id }}?status=5&set=1">Loved Set</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.set_id }}?status=3&set=1">Approved Set</a>
                            <a class="button" href="/admin/beatmaps/edit/{{ i.set_id }}?status=0&set=1">Pending Set</a>
                        </div>
                        <div style="margin-top: 10px">
                            <a class="button" href="/admin/beatmaps/sync/{{ i.set_id }}">
                                Sync Beatmapsets with Bancho
                            </a>
                        </div> #}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<style>
    .bigger_td {
        line-height: 7;
        font-size: 20;
    }

    .play-detail__title {
        color: #fff;
        font-size: 20px;
        display: block;
        align-self: flex-start;
        max-width: 100%;
    }
</style>
<script>$(document).ready(function () {
        $(".dropdown .buttond").click(function () {
            var dropdown = $(this).parents('.dropdown');
            dropdown.toggleClass('is-active');
            dropdown.focusout(function () {
                $(this).removeClass('is-active');
            });
        });

    });
</script>
{% endblock %}